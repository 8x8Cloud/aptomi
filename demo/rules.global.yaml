- name: compromised_cluster_block_sensetive_services
  filterservices:
    cluster:
      accept:
        - compromised
    labels:
      accept:
        - sensetive
  actions:
    - type: ingress
      content: block

- name: compromised_users_forbid_all_services
  filterservices:
    user:
      accept:
        - compromised
    labels:
  actions:
    - type: dependency
      content: forbid

- name: low_prio_users_forbid_sensetive_services
  filterservices:
    user:
      accept:
        - priority < 100
    labels:
      accept:
        - sensetive
  actions:
    - type: dependency
      content: forbid

- name: dev_cluster_forbid_sensetive_service
  filterservices:
    cluster:
      accept:
        - dev
    labels:
      accept:
        - sensetive
  actions:
    - type: dependency
      content: forbid
