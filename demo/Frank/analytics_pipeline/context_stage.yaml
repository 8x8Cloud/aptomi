# This context is for people from dev
- kind: context

  metadata:
    namespace: main
    name: stage-analytics-ops

  spec:
    # Applies to all services owned by 'analytics-ops-team'
    # For consumers with org == 'dev'
    criteria:
      require-all:
        - service.Owner.Labels.team == 'analytics-ops-team'
      require-any:
        - org == 'dev'


    # In stage:
    # - service will be deployed in us-west
    # - all consumers will rely on the same instance of analytics_pipeline
    allocation:
      name: "staging"
      change-labels:
        set:
          cluster: cluster-us-west
