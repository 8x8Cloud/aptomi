# Definition of Spark service
name: spark

labels:
  set:
    a: b

components:

  - name: zookeeper
    service: zookeeper
    labels:
      set: # add/modify
        some-test-context-specific-label: some-value
      remove:
        a:
        b:

  - name: spark
    code:
      type: aptomi/code/kubernetes-helm
      metadata:
        chartName: spark-1.0.0
      params:
        spark:
          image:
            repository: mirantisworkloads/spark
            tag: 2.1.0
            pullPolicy: Always
          master:
            replicas: 1
          worker:
            replicas: 1

        zeppelin:
          image:
            repository: mirantisworkloads/zeppelin
            tag: 0.7.1
            pullPolicy: Always

        service:
          type: NodePort

        zookeeper:
          deployChart: false
          externalAddress: zk-{{ .Components.zookeeper.zookeeper }}-0.zk-{{ .Components.zookeeper.zookeeper }}:2181
    labels:
      set: # add/modify
        some-test-context-specific-label: some-value
      remove:
        a:
        b:
    dependencies:
      - zookeeper
