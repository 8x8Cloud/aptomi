# Definition of Analytics Pipeline service
- metadata:
    kind: service
    namespace: main
    name: analytics_pipeline

  owner: cn=Frank,ou=people,o=aptomiOrg

  components:

    - name: kafka
      contract: kafka

    - name: spark
      contract: spark

    - name: hdfs
      contract: hdfs

# Contract for Analytics Pipeline
- metadata:
    kind: contract
    namespace: main
    name: analytics_pipeline

  contexts:
    # Production instance of the service (operated by ops/IT)
    - name: prod
      criteria:
        require-all:
          - org == 'it' && is_operator
      change-labels:
        set:
          cluster: cluster-us-east
      allocation:
        service: analytics_pipeline

    # Staging instance of the service (for developers)
    - name: stage
      criteria:
        require-all:
          - org == 'dev'
      change-labels:
        set:
          cluster: cluster-us-west
      allocation:
        service: analytics_pipeline