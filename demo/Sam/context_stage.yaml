# This context describes twitter_stats in staging
- kind: context

  metadata:
    namespace: main
    name: stage-istio

  spec:
    # Only applies to istio service
    # For consumers with org == 'dev'
    criteria:
      require-all:
        - service.Metadata.Name == 'istio'
      require-any:
        - org == 'dev'

    # Set cluster label to deploy in us-west
    change-labels:
      set:
        cluster: cluster-us-west

    # Each dev will get their own instance
    allocation:
      name: stage
