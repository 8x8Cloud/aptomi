# Context definition for prod (high priority)
- kind: context

  metadata:
    namespace: main
    name: prod-high

  spec:
    labels:
      set:
        some-test-context-specific-label: some-value
      remove:
        a:
        b:

    criteria:
      accept:
        - dev == "no" && prod == "yes" && priority >= 200
      reject:
        - service.Name == "zookeeper" && nozookeeper

    allocation:
      name: "prod-{{.User.Name}}"
      labels:
        set:
          some-test-context-specific-label: some-value
        remove:
          a:
          b:

# Context definition for prod (low priority)
- kind: context

  metadata:
    namespace: main
    name: prod-low

  spec:
    labels:
      set:
        some-test-context-specific-label: some-value
      remove:
        a:
        b:

    criteria:
      accept:
        - dev == "no" && prod == "yes" && priority < 200
      reject:
        - service.Name == "zookeeper" && nozookeeper

    allocation:
      name: "prod-team-{{.User.Labels.team}}"
      labels:
        set:
          some-test-context-specific-label: some-value
        remove:
          a:
          b:

# Context definition for test
- kind: context

  metadata:
    namespace: main
    name: test


  spec:
    labels:
      set:
        some-test-context-specific-label: some-value
      remove:
        a:
        b:

    criteria:
      accept:
        - dev == "yes" && prod == "no"
      reject:
        - service.Name == "zookeeper" && nozookeeper

    allocation:
      name: "test-{{.User.Labels.team}}"
      labels:
        set:
          some-test-context-specific-label: some-value
        remove:
          a:
          b:
