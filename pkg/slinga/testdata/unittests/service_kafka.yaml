- metadata:
    kind: service
    namespace: main
    name: kafka

  owner: 1

  change-labels:
    set:
      a: b

  components:
    - name: component1
      service: zookeeper
      change-labels:
        set: # add/modify
          some-test-context-specific-label: some-value
        remove:
          a:
          b:

    - name: component2
      discovery:
        url: "kafka-{{ .Discovery.instance }}-url"
      code:
        type: aptomi/code/unittests
        params:
          cluster: cluster-us-east
          address: "{{ .Discovery.component1.component2.instance }}"
          queue: "{{ .User.Labels.changinglabel }}"
          someparam: "{{ index .Labels \"some-test-context-specific-label\" }}"
          secretparam: "{{ .User.Secrets.bigsecret }}"
          data1:
            param:
              name: value1
          data2:
            param:
              name: value2
          data3:
            param:
              name: value3
          data4:
            param:
              name: value4
          data5:
            param:
              name: value5
          data6:
            param:
              name: 123456789
          data7:
            param:
              name: true
          data8:
            param:
              name: false
      change-labels:
        set: # add/modify
          some-test-context-specific-label: some-value
        remove:
          a:
          b:
      dependencies:
        - component1