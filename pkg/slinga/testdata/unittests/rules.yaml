- metadata:
    kind: rule
    namespace: main
    name: compromised_cluster_block_sensitive_services
  filterservices:
    cluster:
      require-any:
        - compromised
    labels:
      require-any:
        - sensitive
  actions:
    - type: ingress
      content: block

- metadata:
    kind: rule
    namespace: main
    name: compromised_users_forbid_all_services
  filterservices:
    user:
      require-any:
        - compromised
    labels:
  actions:
    - type: dependency
      content: forbid

- metadata:
    kind: rule
    namespace: main
    name: low_prio_users_forbid_sensitive_services
  filterservices:
    user:
      require-any:
        - priority < 100
    labels:
      require-any:
        - sensitive
  actions:
    - type: dependency
      content: forbid

- metadata:
    kind: rule
    namespace: main
    name: dev_cluster_forbid_sensitive_service
  filterservices:
    cluster:
      require-any:
        - dev
    labels:
      require-any:
        - sensitive
  actions:
    - type: dependency
      content: forbid
