- metadata:
    kind: rule
    namespace: main
    name: compromised_users_cannot_instantiate_services
  weight: 1000
  criteria:
    require-all:
      - compromised
  actions:
    dependency: reject

- metadata:
    kind: rule
    namespace: main
    name: low_priority_users_cannot_instantiate_sensitive_services
  weight: 2000
  criteria:
    require-all:
      - priority < 100
      - sensitive
  actions:
    dependency: reject

- metadata:
    kind: rule
    namespace: main
    name: allow-kafka
  weight: 100000
  criteria:
    require-all:
      - service.Name == 'kafka'
  actions:
    dependency: allow
    change-labels:
      set:
        cluster: cluster-us-east

- metadata:
    kind: rule
    namespace: main
    name: allow-zookeeper
  weight: 200000
  criteria:
    require-all:
      - service.Name == 'zookeeper'
  actions:
    dependency: allow
    change-labels:
      set:
        cluster: cluster-us-west
