# Context definition for prod (high priority)
- kind: context

  metadata:
    namespace: main
    name: prod-high

  spec:
    change-labels:
      set:
        some-test-context-specific-label: some-value
      remove:
        a:
        b:

    criteria:
      require-any:
        - dev == "no" && prod == "yes" && priority >= 200
      require-none:
        - service.Metadata.Name == "zookeeper" && nozookeeper

    allocation:
      name: "prod-{{.User.Name}}"
      change-labels:
        set:
          some-test-context-specific-label: some-value
        remove:
          a:
          b:

# Context definition for prod (low priority)
- kind: context

  metadata:
    namespace: main
    name: prod-low

  spec:
    change-labels:
      set:
        prod-low-ctx: true
      remove:
        some-label-to-be-removed:

    criteria:
      require-any:
        - dev == "no" && prod == "yes" && priority < 200
      require-none:
        - service.Metadata.Name == "zookeeper" && nozookeeper

    allocation:
      name: "prod-team-{{.User.Labels.team}}"
      change-labels:
        set:
          prod-low-alloc: true
        remove:
          a:
          b:

# Context definition for test
- kind: context

  metadata:
    namespace: main
    name: test

  spec:
    change-labels:
      set:
        some-test-context-specific-label: some-value
      remove:
        a:
        b:

    criteria:
      require-all:
        - 10 > 5
        - 20 > 10
        - 100 > 50
      require-any:
        - dev == "yes" && prod == "no"
      require-none:
        - service.Metadata.Name == "zookeeper" && nozookeeper

    allocation:
      name: "test-{{.User.Labels.team}}"
      change-labels:
        set:
          some-test-context-specific-label: some-value
        remove:
          a:
          b:
