<!DOCTYPE html>
<html>

<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Aptomi | Home</title>

    <link href="public/css/bootstrap.min.css" rel="stylesheet">
    <link href="public/font-awesome/css/font-awesome.css" rel="stylesheet">

    <link href="public/css/animate.css" rel="stylesheet">
    <link href="public/css/style.css" rel="stylesheet">

    <link href="public/vis/dist/vis-network.min.css" rel="stylesheet" type="text/css"/>

    <style>
        #mygraph {
            color: #d3d3d3;
            background-color: #222222;
            border: 1px solid #444444;
            font: 12pt arial;
            width: 100%;
            height: 435px;
        }
    </style>

    <link href="/favicon.ico?v=42" rel="icon">

</head>

<body class="top-navigation">

<!--Main body, usually don't need to change-->
<div id="wrapper">
    <div id="page-wrapper" class="gray-bg">
        <div class="row border-bottom white-bg">
            <nav class="navbar navbar-static-top" role="navigation">
                <div class="navbar-header">
                    <button aria-controls="navbar" aria-expanded="false" data-target="#navbar" data-toggle="collapse" class="navbar-toggle collapsed" type="button">
                        <i class="fa fa-reorder"></i>
                    </button>
                    <a href="#" class="navbar-brand" style="padding: 5px 5px">
                        <img src="public/img/aptomi_logo_2.png" style="height: 40px">
                    </a>
                </div>
                <div class="navbar-collapse collapse" id="navbar">
                    <ul class="nav navbar-nav">
                        <router-link v-for="item in routes" v-bind:to="item.path" tag="li">
                            <a role="button"> {{ item.title }}</a>
                        </router-link>
                    </ul>
                    <ul class="nav navbar-top-links navbar-right">
                        <li>
                            <a href="#">
                                <i class="fa"></i> [TODO: Select Run]
                            </a>
                        </li>
                        <li>
                            <a href="#">
                                <i class="fa"></i> User: <span>{{ user.name }}</span>
                                &nbsp;
                                <span class="label label-danger pull-right">Global IT Ops</span>
                            </a>
                        </li>
                        <li>
                            <a href="/api/logout?redirect=/ui/login.html">
                                <i class="fa fa-sign-out"></i> Log out
                            </a>
                        </li>
                    </ul>
                </div>
            </nav>
        </div>
        <div class="wrapper wrapper-content">
            <div class="container">
                <router-view></router-view>
            </div>
        </div>
        <div class="footer">
            <!--<div class="pull-right">-->
                <!--10GB of <strong>250GB</strong> Free.-->
            <!--</div>-->
            <div>
                <strong>Copyright</strong> Aptomi &copy; 2017
            </div>
        </div>

    </div>
</div>

<!--JS-->
<!-- Mainly scripts -->
<script src="public/js/jquery-3.1.1.min.js"></script>
<script src="public/js/bootstrap.min.js"></script>
<script src="public/js/plugins/metisMenu/jquery.metisMenu.js"></script>
<script src="public/js/plugins/slimscroll/jquery.slimscroll.min.js"></script>

<!-- Custom and plugin javascript -->
<script src="public/js/inspinia.js"></script>
<script src="public/js/plugins/pace/pace.min.js"></script>

<script src="public/js/vue.min.js"></script>
<script src="public/js/vue-router.min.js"></script>

<script src="public/js/js.cookie-2.1.4.min.js"></script>

<script type="text/javascript" src="public/vis/dist/vis.js"></script>
<script type="text/javascript" src="public/vis/dist/vis-util.js"></script>

<!--Template for /details filter-->
<script type="text/x-template" id="template-details-filter">
    <div class="btn-group">
        <button type="button" class="btn btn-primary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <span>{{ current_title.length != 0 ? current_title : 'Not available' }}</span>
            &nbsp;
            <span class="caret"></span>
        </button>
        <ul class="dropdown-menu">
            <router-link v-for="item in items"
                         v-bind:to="{ name: 'details', params: { view: target_view.length == 0 ? item.name : target_view, filter: target_view.length != 0 ? item.name : ':filter' } }"
                         tag="li">
                <a> {{ item.title }}</a>
            </router-link>
        </ul>
    </div>
</script>

<!--JS for /details/filter-->
<script>
    const CompDetailsFilter = Vue.component('details-filter', {
        template: '#template-details-filter',
        props: ['items', 'current_title', 'target_view']
    })
</script>

<!--Template for /details-->
<script type="text/x-template" id="template-details">
    <div>
        <div class="row animated fadeInUp">
            <div class="col-lg-12">
                <div class="ibox float-e-margins">
                    <div class="ibox-content">
                        <div class="row m-b-xs">
                            <div class="col-sm-12">
                                <span class="m-l-xs m-r-sm">View: </span>
                                <details-filter v-bind:items="views" v-bind:current_title="curr_view_title" target_view=""/>

                                <span v-if="items.length > 0" class="m-l-sm m-r-sm">{{ filter_name }}: </span>
                                <details-filter v-if="items.length > 0"
                                                v-bind:items="items" v-bind:current_title="curr_filter_title" v-bind:target_view="curr_view"/>

                            </div>
                        </div>
                        <div id="mygraph"></div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row animated fadeInUp">
            <div class="col-lg-12">
                <div class="ibox float-e-margins">
                    <div class="ibox-title">
                        <h5>Details</h5>
                    </div>
                    <div class="ibox-content">
                        <div id="mypanel">No data loaded</div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row animated fadeInUp">
            <div class="col-lg-12">
                <div class="ibox float-e-margins">
                    <div class="" id="ibox-content">

                        <div id="vertical-timeline" class="vertical-container light-timeline">
                            <div class="vertical-timeline-block">
                                <div class="vertical-timeline-icon navy-bg">
                                    <i class="fa fa-briefcase"></i>
                                </div>

                                <div class="vertical-timeline-content">
                                    <h2>Meeting</h2>
                                    <p>Conference on the sales results for the previous year. Monica please examine sales trends in marketing and products. Below please find the current status of the sale.
                                    </p>
                                    <a href="#" class="btn btn-sm btn-primary"> More info</a>
                                    <span class="vertical-date">
                                        Today <br/>
                                        <small>Dec 24</small>
                                    </span>
                                </div>
                            </div>

                            <div class="vertical-timeline-block">
                                <div class="vertical-timeline-icon blue-bg">
                                    <i class="fa fa-file-text"></i>
                                </div>

                                <div class="vertical-timeline-content">
                                    <h2>Send documents to Mike</h2>
                                    <p>Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since.</p>
                                    <a href="#" class="btn btn-sm btn-success"> Download document </a>
                                    <span class="vertical-date">
                                        Today <br/>
                                        <small>Dec 24</small>
                                    </span>
                                </div>
                            </div>

                            <div class="vertical-timeline-block">
                                <div class="vertical-timeline-icon lazur-bg">
                                    <i class="fa fa-coffee"></i>
                                </div>

                                <div class="vertical-timeline-content">
                                    <h2>Coffee Break</h2>
                                    <p>Go to shop and find some products. Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's. </p>
                                    <a href="#" class="btn btn-sm btn-info">Read more</a>
                                    <span class="vertical-date"> Yesterday <br/><small>Dec 23</small></span>
                                </div>
                            </div>

                            <div class="vertical-timeline-block">
                                <div class="vertical-timeline-icon yellow-bg">
                                    <i class="fa fa-phone"></i>
                                </div>

                                <div class="vertical-timeline-content">
                                    <h2>Phone with Jeronimo</h2>
                                    <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Iusto, optio, dolorum provident rerum aut hic quasi placeat iure tempora laudantium ipsa ad debitis unde? Iste voluptatibus minus veritatis qui ut.</p>
                                    <span class="vertical-date">Yesterday <br/><small>Dec 23</small></span>
                                </div>
                            </div>

                            <div class="vertical-timeline-block">
                                <div class="vertical-timeline-icon lazur-bg">
                                    <i class="fa fa-user-md"></i>
                                </div>

                                <div class="vertical-timeline-content">
                                    <h2>Go to the doctor dr Smith</h2>
                                    <p>Find some issue and go to doctor. Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s. </p>
                                    <span class="vertical-date">Yesterday <br/><small>Dec 23</small></span>
                                </div>
                            </div>

                            <div class="vertical-timeline-block">
                                <div class="vertical-timeline-icon navy-bg">
                                    <i class="fa fa-comments"></i>
                                </div>

                                <div class="vertical-timeline-content">
                                    <h2>Chat with Monica and Sandra</h2>
                                    <p>Web sites still in their infancy. Various versions have evolved over the years, sometimes by accident, sometimes on purpose (injected humour and the like). </p>
                                    <span class="vertical-date">Yesterday <br/><small>Dec 23</small></span>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</script>

<!--JS for drawing charts on /details-->
<script>
    const drawChart = function (inputView, userId, dependencyId, serviceName) {
        console.log("Draw chart with params: ")
        console.log(inputView)
        console.log(userId)
        console.log(dependencyId)
        console.log(serviceName)
        console.log("==== Draw")

        // can be service-view, consumer-view, or globalops-view
        var view = inputView + "-view";

        var apiPath = "/api/" + view;
        if (view === "service-view") {
            // service-view = view from the standpoint of service owner
//            var serviceName = "analytics_pipeline";
            apiPath += "?serviceName=" + serviceName;
        } else if (view === "consumer-view") {
            // consumer-view = view from the standpoint of service consumer
//            var userId = "100";
//            var dependencyId = "" //"alice_tests_twitter_stats_in_stage"; // if you pass dependencyId, it will filter. if you don't, it will show all dependencies of a given user
            apiPath += "?userId=" + userId + "&dependencyId=" + dependencyId;
        } else {
            // globalops-view = view from the standpoint of global IT ops
//            var userId = "100";
            apiPath += "?userId=" + userId;
        }

        loadJSON(apiPath, jsonLoaded, function (err) {
            console.log('error')
        });

        // create a network
        var container = document.getElementById('mygraph');
        var options = {
            nodes: {
                font: {
                    size: 12,
                    color: 'white'
                },
                borderWidth: 2,
                chosen: {
                    label: false,
                    node: chosenNode
                }
            },
            edges: {
                width: 1,
                font: {
                    size: 12,
                    strokeWidth: 0,
                    color: 'white',
                    align: 'top'
                }
            },
            groups: {
                service: {
                    shape: 'icon',
                    icon: {
                        face: 'FontAwesome',
                        code: '\uf1b2',
                        size: 50,
                        color: 'red'
                    },
                    color: {
                        border: 'red'
                    }
                },
                serviceInstancePrimary: {
                    font: {
                        color: 'black',
                        multi: 'html'
                    },
                    color: {background: 'rgb(0,255,140)', border: 'darkslategrey'},
                    shape: 'box'
                },
                serviceInstance: {
                    font: {
                        color: 'black',
                        multi: 'html'
                    },
                    color: {background: 'rgb(0,123,199)', border: 'darkslategrey'},
                    shape: 'box'
                },
                dependencyShort: {
                    shape: 'icon',
                    icon: {
                        face: 'FontAwesome',
                        code: '\uf007',
                        size: 50,
                        color: 'orange'
                    }
                },
                dependencyLongResolved: {
                    shape: 'icon',
                    font: {
                        multi: 'html'
                    },
                    icon: {
                        face: 'FontAwesome',
                        code: '\uf234',
                        size: 50,
                        color: 'orange'
                    }
                },
                dependencyLongNotResolved: {
                    shape: 'icon',
                    font: {
                        multi: 'html'
                    },
                    icon: {
                        face: 'FontAwesome',
                        code: '\uf235',
                        size: 50,
                        color: 'red'
                    }
                },
                mints: {color: 'rgb(0,255,140)'},
                source: {
                    color: {border: 'white'}
                }
            },
            layout: {
                randomSeed: 239,
                hierarchical: {
                    direction: "LR",
                    levelSeparation: 220
                }
            },
            interaction: {
                hover: true
            },
            physics: false
        };

        // hack to better display consumer view
        if (view === "consumer-view" || view === "globalops-view") {
            options.layout.hierarchical.levelSeparation = 130;
        }

        function chosenNode(values, id, selected, hovering) {
            values.color = "#ffdd88";
            values.borderColor = "#ff0000";
        }

        function clickedNode(params) {
            params.event = "[original event]";
            var node = this.getNodeAt(params.pointer.DOM);
            var edge = this.getEdgeAt(params.pointer.DOM);

            var id = "";
            if (node) {
                id = node
            } else if (edge) {
                id = edge
            }
            if (id) {
                loadJSON("/api/object-view?id=" + id, objectLoaded, objectNotLoaded);
            } else {
                document.getElementById('mypanel').innerHTML = 'No data loaded'
            }
        }

        function jsonLoaded(jsonData) {
            var data = {
                nodes: jsonData.nodes,
                edges: jsonData.edges
            };

            network = new vis.Network(container, data, options);
            network.on("click", clickedNode);
            network.fit();
        }

        function objectLoaded(jsonData) {
            if (jsonData) {
                document.getElementById('mypanel').innerHTML = '<pre>' + JSON.stringify(jsonData, null, 4) + '</pre>';
            } else {
                document.getElementById('mypanel').innerHTML = 'No data loaded'
            }
        }

        function objectNotLoaded(err) {
            document.getElementById('mypanel').innerHTML = '<h2>Unable to load data</h2>' + err
        }
    };
</script>

<!--JS for /details-->
<script>
    const CompDetails = Vue.component('details', {
        template: '#template-details',
        data: function () {
            return {
                curr_view: "",
                curr_filter: "",

                curr_view_title: "",
                curr_filter_title: "",

                filter_name: "",

                views: [],

                items: []
            }
        },
        created: function () {
            this.fetch_data()
        },
        watch: {
            '$route': 'fetch_data'
        },
        methods: {
            fetch_data: function () {
                var ctx = this;

                $("#mygraph").html("");

                loadJSON("/api/details", function (jsonData) {
                    var view = ctx.$route.params.view;
                    var filter = ctx.$route.params.filter;

                    ctx.views = jsonData.Views;

                    if (view === ":view") {
                        router.push({ name: 'details', params: { view: ctx.views[0].name }});
                        return
                    }

                    ctx.curr_view = view;
                    ctx.curr_filter = filter;

                    var userId = "";
                    var dependencyId = "";
                    var serviceName = "";

                    if (view === "service") {
                        ctx.items = jsonData.Services;
                        ctx.filter_name = "Service";

                        // service-view = view from the standpoint of service owner
                        serviceName = filter
                    } else if (view === "consumer") {
                        ctx.items = jsonData.Dependencies;
                        ctx.filter_name = "Dependency";

                        // consumer-view = view from the standpoint of service consumer
                        userId = jsonData.UserId
                        dependencyId = filter === "all" ? "" : filter
                    } else if (view === "globalops"){
                        ctx.items = jsonData.Users;
                        ctx.filter_name = "User";

                        // globalops-view = view from the standpoint of global IT ops
                        userId = filter === "all" ? "" : filter
                    }

                    ctx.views.forEach(function(item) {
                        if (item.name === ctx.curr_view) {
                            ctx.curr_view_title = item.title
                        }
                    });

                    ctx.items.forEach(function(item) {
                        if (item.name === ctx.curr_filter) {
                            ctx.curr_filter_title = item.title
                        }
                    });

                    if (filter === ":filter") {
                        if (ctx.items.length > 0) {
                            router.push({name: 'details', params: {view: view, filter: ctx.items[0].name}})
                        }
                        return
                    }

                    drawChart(ctx.curr_view, userId, dependencyId, serviceName)
                }, function (err) {
                    console.log("/api/details not loaded with err:");
                    console.log(err)
                });
            }
        }
    })
</script>

<!--Template for /home-->
<script type="text/x-template" id="template-home">
    <div>
        <div class="row animated fadeInUp">
            <div class="col-md-2">
                <div class="ibox float-e-margins">
                    <div class="ibox-title">
                        <span class="label label-primary pull-right">Total</span>
                        <h5>Services</h5>
                    </div>
                    <div class="ibox-content">
                        <h1 class="no-margins">{{ summary.Services }}</h1>
                    </div>
                </div>
            </div>
            <div class="col-md-2">
                <div class="ibox float-e-margins">
                    <div class="ibox-title">
                        <span class="label label-primary pull-right">Total</span>
                        <h5>Contexts</h5>
                    </div>
                    <div class="ibox-content">
                        <h1 class="no-margins">{{ summary.Contexts }}</h1>
                    </div>
                </div>
            </div>
            <div class="col-md-2">
                <div class="ibox float-e-margins">
                    <div class="ibox-title">
                        <span class="label label-primary pull-right">Total</span>
                        <h5>Clusters</h5>
                    </div>
                    <div class="ibox-content">
                        <h1 class="no-margins">{{ summary.Clusters }}</h1>
                    </div>
                </div>
            </div>
            <div class="col-md-2">
                <div class="ibox float-e-margins">
                    <div class="ibox-title">
                        <span class="label label-primary pull-right">Total</span>
                        <h5>Rules</h5>
                    </div>
                    <div class="ibox-content">
                        <h1 class="no-margins">{{ summary.Rules }}</h1>
                    </div>
                </div>
            </div>
            <div class="col-md-2">
                <div class="ibox float-e-margins">
                    <div class="ibox-title">
                        <span class="label label-primary pull-right">Total</span>
                        <h5>Users</h5>
                    </div>
                    <div class="ibox-content">
                        <h1 class="no-margins">{{ summary.Users }}</h1>
                    </div>
                </div>
            </div>
            <div class="col-md-2">
                <div class="ibox float-e-margins">
                    <div class="ibox-title">
                        <span class="label label-primary pull-right">All</span>
                        <h5>Dependencies</h5>
                    </div>
                    <div class="ibox-content">
                        <h1 class="no-margins">{{ summary.Dependencies }}</h1>
                    </div>
                </div>
            </div>
        </div>

        <div class="row animated fadeInUp">
            <div class="col-md-2">
                <div class="ibox float-e-margins">
                    <div class="ibox-title">
                        <span class="label label-success pull-right">Owner</span>
                        <h5>Services</h5>
                    </div>
                    <div class="ibox-content">
                        <h1 class="no-margins">{{ services }}</h1>
                        <!--<div class="stat-percent font-bold text-success">98% <i class="fa fa-bolt"></i></div>-->
                        <!--<small>Total views</small>-->
                    </div>
                </div>
            </div>

            <!--<div class="col-md-2">-->
                <!--<div class="ibox float-e-margins">-->
                    <!--<div class="ibox-title">-->
                        <!--<span class="label label-success pull-right">Owner</span>-->
                        <!--<h5>Contexts</h5>-->
                    <!--</div>-->
                    <!--<div class="ibox-content">-->
                        <!--<h1 class="no-margins">8</h1>-->
                        <!--&lt;!&ndash;<div class="stat-percent font-bold text-success">98% <i class="fa fa-bolt"></i></div>&ndash;&gt;-->
                        <!--&lt;!&ndash;<small>Total views</small>&ndash;&gt;-->
                    <!--</div>-->
                <!--</div>-->
            <!--</div>-->

            <div class="col-md-2">
                <div class="ibox float-e-margins">
                    <div class="ibox-title">
                        <span class="label label-success pull-right">Me</span>
                        <h5>Dependencies</h5>
                    </div>
                    <div class="ibox-content">
                        <h1 class="no-margins">{{ dependencies }}</h1>
                        <!--<div class="stat-percent font-bold text-success">98% <i class="fa fa-bolt"></i></div>-->
                        <!--<small>Total views</small>-->
                    </div>
                </div>
            </div>
        </div>

        <div class="row animated fadeInUp">
            <div class="col-lg-12">
                <div class="ibox float-e-margins">
                    <div class="ibox-title">
                        <span class="label label-primary pull-left">Global Dependencies</span>
                    </div>
                    <div class="ibox-content">
                        <div class="table-responsive">
                            <table class="table table-striped">
                                <thead>
                                <tr>
                                    <th>User</th>
                                    <th>Depends on</th>
                                    <th>Context</th>
                                    <th>Cluster</th>
                                    <th>Stats</th>
                                    <th>Action</th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr>
                                    <td>Alice</td>
                                    <td>analytics_pipeline</td>
                                    <td>prod/production</td>
                                    <td>cluster-us-east</td>
                                    <td>128 containers / 3 hours running</td>
                                    <td>[View]</td>
                                </tr>
                                </tbody>
                            </table>
                        </div>

                    </div>
                </div>
            </div>
        </div>

        <div class="row animated fadeInUp">
            <div class="col-lg-12">
                <div class="ibox float-e-margins">
                    <div class="ibox-title">
                        <span class="label label-primary pull-left">Global Rules</span>
                    </div>
                    <div class="ibox-content">
                        <div class="table-responsive">
                            <table class="table table-striped">
                                <thead>
                                <tr>
                                    <th>Rule</th>
                                    <th>Applied to</th>
                                    <th>Action</th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr>
                                    <td>dev_users_ttl</td>
                                    <td>3 instances</td>
                                    <td>[View]</td>
                                </tr>
                                <tr>
                                    <td>dev_users_huj</td>
                                    <td>0 instances</td>
                                    <td>[View]</td>
                                </tr>
                                <tr>
                                    <td>dev_users_huj2</td>
                                    <td>15 instances</td>
                                    <td>[View]</td>
                                </tr>
                                </tbody>
                            </table>
                        </div>

                    </div>
                </div>
            </div>
        </div>

        <div class="row animated fadeInUp">
            <div class="col-lg-12">
                <div class="ibox float-e-margins">
                    <div class="ibox-title">
                        <span class="label label-primary pull-left">Services I own</span>
                    </div>
                    <div class="ibox-content">
                        <div class="table-responsive">
                            <table class="table table-striped">
                                <thead>
                                <tr>
                                    <th>Service</th>
                                    <th>Context</th>
                                    <th>Cluster</th>
                                    <th>Stats</th>
                                    <th>Action</th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr>
                                    <td>analytics_pipeline</td>
                                    <td>prod/production</td>
                                    <td>cluster-us-east</td>
                                    <td>128 containers / 3 hours running</td>
                                    <td>[View]</td>
                                </tr>
                                <tr>
                                    <td>analytics_pipeline</td>
                                    <td>stage/shit</td>
                                    <td>cluster-us-west</td>
                                    <td>50 containers / 3 hours running</td>
                                    <td>[View]</td>
                                </tr>
                                </tbody>
                            </table>
                        </div>

                    </div>
                </div>
            </div>
        </div>

        <div class="row animated fadeInUp">
            <div class="col-lg-12">
                <div class="ibox float-e-margins">
                    <div class="ibox-title">
                        <span class="label label-primary pull-left">Services I am using</span>
                    </div>
                    <div class="ibox-content">
                        <div class="table-responsive">
                            <table class="table table-striped">
                                <thead>
                                <tr>
                                    <th>Service</th>
                                    <th>Context</th>
                                    <th>Cluster</th>
                                    <th>Stats</th>
                                    <th>Action</th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr>
                                    <td>twitter_stats</td>
                                    <td>prod/production</td>
                                    <td>cluster-us-east</td>
                                    <td>128 containers / 3 hours running</td>
                                    <td>[View]</td>
                                </tr>
                                </tbody>
                            </table>
                        </div>

                    </div>
                </div>
            </div>
        </div>

        <div class="row animated fadeInUp" v-for="user_endpoints in all_endpoints">
            <div class="col-lg-12">
                <div class="ibox float-e-margins">
                    <div class="ibox-title">
                        <h5 v-if="all_endpoints.length > 1 && user_endpoints.Endpoints.length > 0">
                            Services Endpoints for user {{ user_endpoints.User.Name }}
                        </h5>
                        <h5 v-if="all_endpoints.length > 1 && user_endpoints.Endpoints.length == 0">
                            No Services Endpoints for user {{ user_endpoints.User.Name }}
                        </h5>
                        <h5 v-if="all_endpoints.length == 1 && user_endpoints.Endpoints.length > 0">
                            Services Endpoints
                        </h5>
                        <h5 v-if="all_endpoints.length == 1 && user_endpoints.Endpoints.length == 0">
                            No Services Endpoints
                        </h5>
                    </div>
                    <div class="ibox-content" v-if="user_endpoints.Endpoints.length > 0">
                        <div class="table-responsive">
                            <table class="table table-striped">
                                <thead>
                                <tr>
                                    <th>Service </th>
                                    <th>Context </th>
                                    <th>Allocation </th>
                                    <th>Component</th>
                                    <th>Links</th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr v-for="endpoint in user_endpoints.Endpoints">
                                    <td>{{ endpoint.Service }}</td>
                                    <td>{{ endpoint.Context }}</td>
                                    <td>{{ endpoint.Allocation }}</td>
                                    <td>{{ endpoint.Component }}</td>
                                    <td>
                                        <div v-for="link in endpoint.Links">
                                            <a v-bind:href="link.Link">{{ link.Name }}</a>
                                        </div>
                                    </td>
                                </tr>
                                </tbody>
                            </table>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</script>

<!--JS for /home-->
<script>
    const CompHome = Vue.component('home', {
        template: '#template-home',
        data: function () {
            return {
                all_endpoints: {},
                services: 0,
                dependencies: 0,
                summary: {}
            }
        },
        created: function () {
            this.fetch_data()
        },
        watch: {
            '$route': 'fetch_data'
        },
        methods: {
            fetch_data: function () {
                var ctx = this;

                loadJSON("/api/details", function (jsonData) {
                    ctx.services = jsonData.Services.length;
                    ctx.dependencies = jsonData.Dependencies.length;
                    ctx.summary = jsonData.Summary;
                    console.log(ctx);
                }, function (err) {
                    console.log("/api/details not loaded with err:");
                    console.log(err);
                });

                loadJSON("/api/endpoints", function (jsonData) {
                    ctx.all_endpoints = jsonData.Endpoints;
                    console.log(ctx.all_endpoints);
                }, function (err) {
                    console.log("/api/endpoints not loaded with err:");
                    console.log(err);
                })
            }
        }
    });
</script>

<!--Main Vue JS-->
<script>
    const routes = [
        { name: 'home', path: '/home', title: "Home", component: CompHome },
        { name: 'details', path: '/details/:view/:filter', title: 'Details', component: CompDetails },
        { path: '*', redirect: { name: 'home' } }
    ];

    const router = new VueRouter({
        routes: routes,
        linkActiveClass: 'active',
        linkExactActiveClass: 'active'
    });

    const app = new Vue({
        el: '#wrapper',
        router: router,
        data: {
            routes: routes
        },
        computed: {
            user: function () {
                return {
                    name: Cookies.get("logUserName")
                }
            }
        }
    });

</script>

</body>

</html>
