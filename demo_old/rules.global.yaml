- name: compromised_cluster_block_sensitive_services
  filterservices:
    cluster:
      accept:
        - compromised
    labels:
      accept:
        - sensitive
  actions:
    - type: ingress
      content: block

- name: compromised_users_forbid_all_services
  filterservices:
    user:
      accept:
        - compromised
    labels:
  actions:
    - type: dependency
      content: forbid

- name: low_prio_users_forbid_sensitive_services
  filterservices:
    user:
      accept:
        - priority < 100
    labels:
      accept:
        - sensitive
  actions:
    - type: dependency
      content: forbid

- name: dev_cluster_forbid_sensitive_service
  filterservices:
    cluster:
      accept:
        - dev
    labels:
      accept:
        - sensitive
  actions:
    - type: dependency
      content: forbid

- name: nonprod_users_forbid_prod_cluster
  filterservices:
    user:
      accept:
        - super-prod-users
    cluster:
      accept:
        - prod
  actions:
    - type: dependency
      content: allow
